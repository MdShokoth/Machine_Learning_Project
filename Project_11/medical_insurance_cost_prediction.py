# -*- coding: utf-8 -*-
"""Medical_Insurance_Cost_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eljiJ43mFbRuk0GqZJf8zFGgdoJf5V2r
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score

df=pd.read_csv('/content/insurance.csv')

df.head()

df.info()

df.isnull().sum()

df.describe()

df.region.value_counts()

df.smoker.value_counts()

df.sex.value_counts()

sns.set()
plt.figure(figsize=(6,6))
sns.distplot(df['age'],color="green")
plt.title("Distribution of age")
plt.show()

plt.figure(figsize=(6,6))
sns.distplot(df['bmi'],color="green")
plt.title("Distribution of bmi")
plt.show()

plt.figure(figsize=(6,6))
sns.countplot(x='sex',data=df)
plt.title("Distribution of sex")
plt.show()

plt.figure(figsize=(6,6))
sns.countplot(x='smoker',data=df)
plt.title("Distribution of smoker")
plt.show()

plt.figure(figsize=(6,6))
sns.countplot(x='children',data=df)
plt.title("Distribution of region")
plt.show()

plt.figure(figsize=(6,6))
sns.countplot(x='region',data=df)
plt.title("Distribution of region")
plt.show()

df.replace({'sex':{'male':0,'female':1}},inplace=True)
df.replace({'smoker':{'no':0,'yes':1}},inplace=True)
df.replace({'region':{'southeast':0,'southwest':1,'northeast':2,'northwest':3}},inplace=True)

df.head(10)

X=df.drop('charges',axis=1)
Y=df['charges']

X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=2)

model=LinearRegression()

model.fit(X_train,Y_train)

Y_train_predict=model.predict(X_train)

print("r2 score",r2_score(Y_train,Y_train_predict))

Y_test_predict=model.predict(X_test)
print("r2 score",r2_score(Y_test,Y_test_predict))

sample_data=(27,0,42.13,0,1,0)

sample_data=np.asarray(sample_data).reshape(1,-1)

prediction=model.predict(sample_data)
print(prediction)

